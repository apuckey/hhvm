#!/usr/bin/make -f
# -*- makefile -*-
# Sample debian/rules that uses debhelper.
#
# This file was originally written by Joey Hess and Craig Small.
# As a special exception, when this file is copied by dh-make into a
# dh-make output file, you may use that output file without restriction.
# This special exception was added by Craig Small in version 0.37 of dh-make.
#
# Modified to make a template file for a multi-binary package with separated
# build-arch and build-indep targets  by Bill Allombert 2001

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/makefile.mk

# This has to be exported to make some magic below work.
export DH_OPTIONS
export CMAKE_PREFIX_PATH=/usr/hiphop-php
export HPHP_HOME=$(CURDIR)
export HPHP_LIB=$(CURDIR)/bin
export USE_HHVM=1
#export CMAKE_BUILD_TYPE=Debug
#export GOOGLE_CPU_PROFILER=1

autoclean:
	-rm -f $(CURDIR)/CMakeCache.txt

clean:: autoclean
	dh_clean

config: config-stamp
config-stamp:
	cmake .

build: config build-stamp
build-stamp:
	$(MAKE)
